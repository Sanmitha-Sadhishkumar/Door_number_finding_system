<!DOCTYPE html>
<html>
<head>
    <title>Google Street View</title>
</head>
<body>
    <h1>Google Street View</h1>
    <div id="pano" style="width: 100%; height: 400px;"></div>

    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB41DRUbKWJHPxaFjMAwdrzWzbVKartNGg&callback=initMap" async defer></script>
    <script>
        let panorama;
        const step = 0.0001; // Adjust the step value for the amount of movement

        function initMap() {
            const location = { lat: 40.7128, lng: -74.0060 }; // Default location (New York City)
            panorama = new google.maps.StreetViewPanorama(
                document.getElementById('pano'),
                {
                    position: location,
                    pov: { heading: 0, pitch: 0 },
                    visible: true
                }
            );
        }

        function checkStreetViewImageExists(lat, lng, callback) {
            const service = new google.maps.StreetViewService();
            service.getPanorama({ location: { lat: lat, lng: lng }, radius: 50 }, (data, status) => {
                if (status === google.maps.StreetViewStatus.OK) {
                    callback(true);
                } else {
                    callback(false);
                }
            });
        }

        function moveForward() {
            const heading = panorama.getPov().heading;
            const currentLat = panorama.getPosition().lat();
            const currentLng = panorama.getPosition().lng();

            const newLat = currentLat + step * Math.cos(heading / 180 * Math.PI);
            const newLng = currentLng + step * Math.sin(heading / 180 * Math.PI);

            checkStreetViewImageExists(newLat, newLng, (exists) => {
                if (exists) {
                    panorama.setPosition({ lat: newLat, lng: newLng });
                }
            });
        }

        function moveBackward() {
            const heading = panorama.getPov().heading;
            const currentLat = panorama.getPosition().lat();
            const currentLng = panorama.getPosition().lng();

            const newLat = currentLat - step * Math.cos(heading / 180 * Math.PI);
            const newLng = currentLng - step * Math.sin(heading / 180 * Math.PI);

            checkStreetViewImageExists(newLat, newLng, (exists) => {
                if (exists) {
                    panorama.setPosition({ lat: newLat, lng: newLng });
                }
            });
        }

        function moveLeft() {
            const heading = panorama.getPov().heading;
            const currentLat = panorama.getPosition().lat();
            const currentLng = panorama.getPosition().lng();

            const newLat = currentLat - step * Math.sin(heading / 180 * Math.PI);
            const newLng = currentLng + step * Math.cos(heading / 180 * Math.PI);

            checkStreetViewImageExists(newLat, newLng, (exists) => {
                if (exists) {
                    panorama.setPosition({ lat: newLat, lng: newLng });
                }
            });
        }

        function moveRight() {
            const heading = panorama.getPov().heading;
            const currentLat = panorama.getPosition().lat();
            const currentLng = panorama.getPosition().lng();

            const newLat = currentLat + step * Math.sin(heading / 180 * Math.PI);
            const newLng = currentLng - step * Math.cos(heading / 180 * Math.PI);

            checkStreetViewImageExists(newLat, newLng, (exists) => {
                if (exists) {
                    panorama.setPosition({ lat: newLat, lng: newLng });
                }
            });
        }
    </script>
    <button onclick="moveForward()">Move Forward</button>
    <button onclick="moveBackward()">Move Backward</button>
    <button onclick="moveLeft()">Move Left</button>
    <button onclick="moveRight()">Move Right</button>
</body>
</html>
